<div class="p-6 space-y-6">

  <!-- HEADER -->
  <header
    class="bg-gradient-to-r from-slate-700 via-sky-700 to-sky-500
           text-white px-8 py-4 rounded-2xl shadow-md
           flex justify-between items-center">

    <!-- Título -->
    <h2 class="text-xl font-bold tracking-wide m-0">
      PROMOCIONES
    </h2>

    <!-- Usuario -->
    <span class="text-right leading-tight">
      <span class="block text-sm font-light opacity-80">
        Administrador
      </span>
      <span class="block text-sm font-medium">
        Miguel Morales
      </span>
    </span>

  </header>

  <!-- CUADRO BLANCO -->
  <div class="bg-white rounded-2xl shadow-md p-6 space-y-4">

    <!-- BOTÓN AGREGAR PROMOCIÓN -->
    <div class="flex justify-end">
      <button
        class="bg-sky-600 hover:bg-sky-700
               text-white px-5 py-2 rounded-lg shadow
               transition flex items-center gap-2"
        (click)="abrirCrear()">

        <span class="text-xl leading-none">+</span>
        Agregar promoción
      </button>
    </div>

    <!-- GRID DE PROMOCIONES -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">

      <!-- CARDS -->
      <div
        *ngFor="let promo of promociones"
        class="bg-white rounded-xl shadow-md hover:shadow-xl hover:-translate-y-1 transition-all overflow-hidden relative">
      

      <!-- Imagen -->
      <img
        src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTCGZlr4gLcP_lnP-wXWHiXholmsGihWJOqfA&s"
        alt="Promoción"
        class="w-full h-48 object-contain bg-gray-100">

      <!-- Descuento -->
      <span
        class="absolute top-3 right-3 bg-red-600 text-white text-sm font-semibold px-3 py-1 rounded-full">
        -{{ promo.discountValue }}%
      </span>

      <div class="p-4">
        <h2 class="text-lg font-bold text-gray-800">
          {{ promo.namePromotion }}
        </h2>

        <p class="text-sm text-gray-500">
          Código:
          <span class="font-medium">
            {{ promo.typePromotion === 'CODIGO' ? promo.promoCode : 'Automática' }}
          </span>
        </p>

        <p class="text-sm text-gray-500">
          {{ promo.startDate | date }} - {{ promo.endDate | date }}
        </p>

        <div class="flex justify-between mt-4">
          <button
            class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm transition"
            (click)="abrirModalEditar(promo)">
            Editar
          </button>

          <button
            class="bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-sm transition"
            (click)="eliminarPromocion(promo.idPromotion)">
            Eliminar
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- MODAL -->
<div
  *ngIf="mostrarModal"
  class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 animate-fadeIn">

  <div class="bg-white w-full max-w-2xl rounded-xl p-6 animate-scaleIn">
    <h2 class="text-2xl font-bold mb-6 text-gray-800">
      {{ modoEdicion ? 'Editar Promoción' : 'Crear Promoción' }}
    </h2>

    <form class="grid grid-cols-1 md:grid-cols-2 gap-4">

      <!-- Nombre -->
      <div>
        <label class="text-sm font-medium text-gray-700">
          Nombre <span class="text-red-500">*</span>
        </label>
        <input
          class="w-full border rounded px-3 py-2 focus:ring-2 focus:ring-indigo-500"
          [(ngModel)]="form.namePromotion"
          name="namePromotion">
      </div>

      <!-- Tipo promoción -->
      <div>
        <label class="text-sm font-medium text-gray-700">
          Tipo de promoción <span class="text-red-500">*</span>
        </label>
        <select
          class="w-full border rounded px-3 py-2"
          [(ngModel)]="form.typePromotion"
          name="typePromotion">
          <option value="">Seleccione</option>
          <option value="CODIGO">Código</option>
          <option value="AUTOMATICA">Automática</option>
        </select>
      </div>

      <!-- Código (SOLO SI ES CODIGO) -->
      <div
        *ngIf="form.typePromotion === 'CODIGO'"
        class="transition-all duration-300">
        <label class="text-sm font-medium text-gray-700">
          Código promocional <span class="text-red-500">*</span>
        </label>
        <input
          class="w-full border rounded px-3 py-2"
          [(ngModel)]="form.promoCode"
          name="promoCode"
          placeholder="Ej: NAVIDAD2025">
      </div>

      <!-- Tipo descuento -->
      <div>
        <label class="text-sm font-medium text-gray-700">Tipo de descuento</label>
        <select
          class="w-full border rounded px-3 py-2"
          [(ngModel)]="form.discountType"
          name="discountType">
          <option value="PORCENTAJE">Porcentaje</option>
        </select>
      </div>

      <!-- Valor descuento -->
      <div>
        <label class="text-sm font-medium text-gray-700">Valor del descuento</label>
        <input
          type="number"
          class="w-full border rounded px-3 py-2"
          [(ngModel)]="form.discountValue"
          name="discountValue">
      </div>

      <!-- Compra mínima -->
      <div>
        <label class="text-sm font-medium text-gray-700">Compra mínima</label>
        <input
          type="number"
          class="w-full border rounded px-3 py-2"
          [(ngModel)]="form.minPurchase"
          name="minPurchase">
      </div>

      <!-- Cupo máximo -->
      <div>
        <label class="text-sm font-medium text-gray-700">Cupo máximo</label>
        <input
          type="number"
          class="w-full border rounded px-3 py-2"
          [(ngModel)]="form.maxQuota"
          name="maxQuota">
      </div>

      <!-- Fechas -->
      <div>
        <label class="text-sm font-medium text-gray-700">
          Fecha inicio <span class="text-red-500">*</span>
        </label>
        <input
          type="date"
          class="w-full border rounded px-3 py-2"
          [(ngModel)]="form.startDate"
          name="startDate">
      </div>

      <div>
        <label class="text-sm font-medium text-gray-700">
          Fecha fin <span class="text-red-500">*</span>
        </label>
        <input
          type="date"
          class="w-full border rounded px-3 py-2"
          [(ngModel)]="form.endDate"
          name="endDate">
      </div>

    </form>

    <!-- Botones -->
    <div class="flex justify-end gap-3 mt-6">
      <button
        class="px-4 py-2 bg-gray-300 rounded hover:bg-gray-400"
        (click)="cerrarModal()">
        Cancelar
      </button>

      <button
        class="px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700"
        (click)="guardar()">
        {{ modoEdicion ? 'Actualizar' : 'Crear' }}
      </button>
    </div>
  </div>
</div>
