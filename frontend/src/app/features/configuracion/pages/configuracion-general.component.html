<div class="configuracion-layout">

  <!-- HERO HEADER -->
  <div class="hero-header">
    <h1>Configuraci√≥n General</h1>
    <p class="subtitle">Gestiona todos los par√°metros de tu plataforma desde un solo lugar</p>
    
    <!-- Theme Controls -->
    <div class="theme-controls">
      <div class="theme-selector">
        <span class="theme-label">Tema:</span>
        <div class="theme-buttons">
          <button 
            class="theme-btn" 
            [class.active]="currentPreferences.theme === 'light'"
            (click)="setTheme('light')">
            <i class="theme-icon">‚òÄÔ∏è</i>
            Claro
          </button>
          <button 
            class="theme-btn" 
            [class.active]="currentPreferences.theme === 'dark'"
            (click)="setTheme('dark')">
            <i class="theme-icon">üåô</i>
            Oscuro
          </button>
          <button 
            class="theme-btn toggle-btn"
            (click)="toggleTheme()"
            title="Alternar tema">
            <i class="theme-icon">üîÑ</i>
          </button>
        </div>
      </div>
      
      <div class="font-size-control">
        <span class="font-label">Tama√±o de fuente:</span>
        <div class="font-slider-container">
          <input 
            type="range" 
            min="12" 
            max="24" 
            step="1"
            [value]="currentPreferences.fontSize"
            (input)="changeFontSize($event)"
            class="font-slider">
          <span class="font-size-display">{{currentPreferences.fontSize}}px</span>
        </div>
      </div>
      
      <div class="font-family-control">
        <span class="font-label">Tipo de fuente:</span>
        <div class="font-family-selector">
          <select 
            [value]="currentPreferences.fontFamily"
            (change)="changeFontFamily($event)"
            class="font-select">
            <option value="Inter, -apple-system, BlinkMacSystemFont, sans-serif">Inter (Predeterminado)</option>
            <option value="Roboto, Helvetica, Arial, sans-serif">Roboto</option>
            <option value="Open Sans, Helvetica, Arial, sans-serif">Open Sans</option>
            <option value="Lato, Helvetica, Arial, sans-serif">Lato</option>
            <option value="Montserrat, Helvetica, Arial, sans-serif">Montserrat</option>
            <option value="Poppins, Helvetica, Arial, sans-serif">Poppins</option>
            <option value="Source Sans Pro, Helvetica, Arial, sans-serif">Source Sans Pro</option>
            <option value="Nunito, Helvetica, Arial, sans-serif">Nunito</option>
            <option value="Ubuntu, Helvetica, Arial, sans-serif">Ubuntu</option>
            <option value="'Times New Roman', Times, serif">Times New Roman</option>
            <option value="Georgia, serif">Georgia</option>
            <option value="Arial, Helvetica, sans-serif">Arial</option>
            <option value="Verdana, Geneva, sans-serif">Verdana</option>
          </select>
        </div>
      </div>
    </div>
    
    <!-- Search/Filtro Bar -->
    <div class="search-filtro-bar">
      <div class="search-container">
        <input type="text" class="search-input" placeholder="Buscar configuraci√≥n..." [(ngModel)]="terminoBusqueda" (input)="buscarConfiguracion()">
        <i class="search-icon">üîç</i>
      </div>
      <div class="filtro-options">
        <button class="filtro-btn" [class.active]="filtroActual === 'todas'" (click)="aplicarFiltro('todas')">Todas</button>
        <button class="filtro-btn" [class.active]="filtroActual === 'plataforma'" (click)="aplicarFiltro('plataforma')">Plataforma</button>
        <button class="filtro-btn" [class.active]="filtroActual === 'negocio'" (click)="aplicarFiltro('negocio')">Negocio</button>
        <button class="filtro-btn" [class.active]="filtroActual === 'legales'" (click)="aplicarFiltro('legales')">Legal</button>
        <button class="filtro-btn" [class.active]="filtroActual === 'faq'" (click)="aplicarFiltro('faq')">FAQ</button>
      </div>
    </div>
  </div>

  <form (ngSubmit)="guardarConfiguracion()" #configForm="ngForm" class="config-form">
    <!-- ================= PLATAFORMA ================= -->
    <div class="config-card" *ngIf="mostrarSeccion('plataforma')">
      <div class="card-header" (click)="toggleSection('plataforma')">
        <h3><i class="icon-settings"></i> Par√°metros de la Plataforma</h3>
        <div class="card-toggle">
          <i [class]="getSectionIcon('plataforma')"></i>
        </div>
      </div>

      <div class="card-content" [class.expanded]="isSectionExpanded('plataforma')">
        <div class="form-grid">
          <div class="form-group">
            <label for="nombreComercial">Nombre Comercial</label>
            <input 
              type="text" 
              id="nombreComercial" 
              name="nombreComercial"
              [(ngModel)]="configData.nombreComercial" 
              class="form-control"
              placeholder="Nombre de la plataforma">
            <span class="input-helper">Nombre que se mostrar√° en la plataforma</span>
          </div>

          <div class="form-group">
            <label for="logo">Logo</label>
            <input 
              type="url" 
              id="logo" 
              name="logo"
              [(ngModel)]="configData.logo" 
              class="form-control"
              placeholder="https://ejemplo.com/logo.png">
            <span class="input-helper">URL del logo (se mostrar√° una vista previa)</span>
            
            <div class="logo-preview" *ngIf="configData.logo">
              <img [src]="configData.logo" [alt]="'Logo de ' + configData.nombreComercial" class="logo-image">
            </div>
          </div>

          <div class="form-group full-width">
            <label>Colores B√°sicos</label>
            <div class="color-pickers">
              <div class="color-picker-item">
                <label>Primario</label>
                <div class="color-picker-wrapper">
                  <input 
                    type="color" 
                    name="colorPrimario"
                    [(ngModel)]="configData.colores.primario" 
                    class="color-input">
                  <span class="color-value">{{configData.colores.primario}}</span>
                </div>
              </div>
              
              <div class="color-picker-item">
                <label>Secundario</label>
                <div class="color-picker-wrapper">
                  <input 
                    type="color" 
                    name="colorSecundario"
                    [(ngModel)]="configData.colores.secundario" 
                    class="color-input">
                  <span class="color-value">{{configData.colores.secundario}}</span>
                </div>
              </div>
              
              <div class="color-picker-item">
                <label>Fondo</label>
                <div class="color-picker-wrapper">
                  <input 
                    type="color" 
                    name="colorFondo"
                    [(ngModel)]="configData.colores.fondo" 
                    class="color-input">
                  <span class="color-value">{{configData.colores.fondo}}</span>
                </div>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label for="emailContacto">Email de Contacto</label>
            <input 
              type="email" 
              id="emailContacto" 
              name="emailContacto"
              [(ngModel)]="configData.contacto.email" 
              class="form-control"
              placeholder="contacto@ejemplo.com">
          </div>

          <div class="form-group">
            <label for="telefonoContacto">Tel√©fono de Contacto</label>
            <input 
              type="tel" 
              id="telefonoContacto" 
              name="telefonoContacto"
              [(ngModel)]="configData.contacto.telefono" 
              class="form-control"
              placeholder="+1 234 567 8900">
          </div>

          <div class="form-group full-width">
            <label for="direccionContacto">Direcci√≥n</label>
            <input 
              type="text" 
              id="direccionContacto" 
              name="direccionContacto"
              [(ngModel)]="configData.contacto.direccion" 
              class="form-control"
              placeholder="Calle 123, Ciudad, Pa√≠s">
          </div>
        </div>
      </div>
    </div>

    <!-- ================= LEGALES ================= -->
    <div class="config-card" *ngIf="mostrarSeccion('legales')">
      <div class="card-header" (click)="toggleSection('legales')">
        <h3><i class="icon-document"></i> Textos Legales</h3>
        <div class="card-toggle">
          <i [class]="getSectionIcon('legales')"></i>
        </div>
      </div>

      <div class="card-content" [class.expanded]="isSectionExpanded('legales')">
        <div class="form-grid">
          <div class="form-group full-width">
            <label for="terminos">T√©rminos y Condiciones</label>
            <textarea 
              id="terminos" 
              name="terminos"
              [(ngModel)]="configData.textosLegales.terminos" 
              class="form-control textarea-lg"
              rows="6"
              placeholder="T√©rminos y condiciones de la plataforma"></textarea>
            <span class="input-helper">Estos t√©rminos se mostrar√°n a los usuarios durante el proceso de compra</span>
          </div>

          <div class="form-group full-width">
            <label for="politica">Pol√≠tica de Privacidad</label>
            <textarea 
              id="politica" 
              name="politica"
              [(ngModel)]="configData.textosLegales.politica" 
              class="form-control textarea-lg"
              rows="6"
              placeholder="Pol√≠tica de privacidad"></textarea>
            <span class="input-helper">Informaci√≥n sobre c√≥mo se manejan los datos personales</span>
          </div>

          <div class="form-group full-width">
            <label for="mensajesCompra">Mensajes Informativos en la Compra</label>
            <textarea 
              id="mensajesCompra" 
              name="mensajesCompra"
              [(ngModel)]="configData.textosLegales.mensajesCompra" 
              class="form-control textarea-md"
              rows="4"
              placeholder="Mensajes informativos que se mostrar√°n durante la compra"></textarea>
            <span class="input-helper">Mensajes que aparecer√°n durante el proceso de compra</span>
          </div>
        </div>
      </div>
    </div>

    <!-- ================= FAQ ================= -->
    <div class="config-card" *ngIf="mostrarSeccion('faq')">
      <div class="card-header" (click)="toggleSection('faq')">
        <h3><i class="icon-help"></i> Preguntas Frecuentes (FAQ)</h3>
        <div class="card-toggle">
          <i [class]="getSectionIcon('faq')"></i>
        </div>
      </div>

      <div class="card-content" [class.expanded]="isSectionExpanded('faq')">
        <div class="faq-section">
          <div class="faq-controls">
            <button type="button" class="btn btn-secondary" (click)="agregarFAQ()">
              <i class="icon-plus"></i> Agregar Pregunta
            </button>
          </div>

          <div class="faq-list" *ngIf="configData.faqs && configData.faqs.length > 0">
            <div class="faq-item" *ngFor="let faq of configData.faqs; let i = index">
              <div class="faq-header">
                <input 
                  type="text" 
                  class="faq-question-input"
                  [(ngModel)]="faq.pregunta" 
                  [ngModelOptions]="{standalone: true}"
                  placeholder="Pregunta">
                <div class="faq-actions">
                  <button type="button" class="btn-icon move-up" (click)="moverFAQArriba(i)" [disabled]="i === 0">
                    <i class="icon-arrow-up"></i>
                  </button>
                  <button type="button" class="btn-icon move-down" (click)="moverFAQAbajo(i)" [disabled]="i === configData.faqs.length - 1">
                    <i class="icon-arrow-down"></i>
                  </button>
                  <button type="button" class="btn-icon delete" (click)="eliminarFAQ(i)">
                    <i class="icon-trash"></i>
                  </button>
                </div>
              </div>
              <div class="faq-body">
                <textarea 
                  class="faq-answer-textarea"
                  [(ngModel)]="faq.respuesta" 
                  [ngModelOptions]="{standalone: true}"
                  placeholder="Respuesta" 
                  rows="3"></textarea>
              </div>
            </div>
          </div>

          <div class="empty-state" *ngIf="!configData.faqs || configData.faqs.length === 0">
            <i class="icon-help-circle"></i>
            <p>No hay preguntas frecuentes a√∫n</p>
            <button type="button" class="btn btn-secondary" (click)="agregarFAQ()">
              <i class="icon-plus"></i> Agregar la primera pregunta
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- ================= NEGOCIO ================= -->
    <div class="config-card" *ngIf="mostrarSeccion('negocio')">
      <div class="card-header" (click)="toggleSection('negocio')">
        <h3><i class="icon-business"></i> Configuraci√≥n de Negocio</h3>
        <div class="card-toggle">
          <i [class]="getSectionIcon('negocio')"></i>
        </div>
      </div>

      <div class="card-content" [class.expanded]="isSectionExpanded('negocio')">
        <div class="form-grid">
          <div class="form-group">
            <label for="moneda">Moneda por Defecto</label>
            <select 
              id="moneda" 
              name="moneda"
              [(ngModel)]="configData.negocio.moneda" 
              class="form-control">
              <option value="USD">USD - D√≥lar Estadounidense</option>
            </select>
          </div>

          <div class="form-group">
            <label for="limiteTickets">L√≠mite de Tickets por Cliente por Evento</label>
            <input 
              type="number" 
              id="limiteTickets" 
              name="limiteTickets"
              [(ngModel)]="configData.negocio.limiteTickets" 
              class="form-control"
              min="1"
              max="100"
              placeholder="N√∫mero m√°ximo de tickets">
            <span class="input-helper">Cantidad m√°xima de tickets que un cliente puede comprar por evento</span>
          </div>

          <div class="form-group checkbox-group">
            <div class="checkbox-wrapper">
              <label class="checkbox-container">
                <input 
                  type="checkbox" 
                  name="transporteHabilitado"
                  [(ngModel)]="configData.negocio.transporteHabilitado">
                <span class="checkmark"></span>
                Activar venta de transporte
              </label>
            </div>
            <span class="input-helper">Permitir la venta de servicios de transporte en la plataforma</span>
          </div>

          <div class="form-group checkbox-group">
            <div class="checkbox-wrapper">
              <label class="checkbox-container">
                <input 
                  type="checkbox" 
                  name="productosHabilitados"
                  [(ngModel)]="configData.negocio.productosHabilitados">
                <span class="checkmark"></span>
                Activar venta de productos adicionales
              </label>
            </div>
            <span class="input-helper">Habilitar la venta de productos adicionales junto con los tickets</span>
          </div>
        </div>
      </div>
    </div>

    <!-- ================= BOT√ìN ================= -->
    <div class="form-actions">
      <button type="submit" class="btn btn-primary">
        Guardar Configuraci√≥n
      </button>
    </div>
  </form>
</div>
